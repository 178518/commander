<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>Commander::UI::ProgressBar</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link rel="stylesheet" href="../../../css/reset.css" type="text/css" media="screen" />
    <link rel="stylesheet" href="../../../css/main.css" type="text/css" media="screen" />
    <script src="../../../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../../js/main.js" type="text/javascript" charset="utf-8"></script>
</head>

<body>     
    <div class="banner">
        <h1>
            <span class="type">Class</span> 
            Commander::UI::ProgressBar 
            
                <span class="parent">&lt; 
                    
                    <a href="../../Object.html">Object</a>
                    
                </span>
            
        </h1>
        <ul class="files">
            
            <li><a href="../../../files/lib/commander/user_interaction_rb.html">lib/commander/user_interaction.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
    
    <div class="description">
        
<h1>Progress Bar</h1>

<p>Terminal progress bar utility. In its most basic form requires that the
developer specifies when the bar should be incremented. Note that a hash of
tokens may be passed to <a
href="ProgressBar.html#method-i-increment">increment</a>, (or returned when
using <a href="../UI.html#method-i-progress">Object#progress</a>).</p>

<pre>uris = %w( 
  http://vision-media.ca
  http://yahoo.com
  http://google.com
  )

bar = Commander::UI::ProgressBar.new uris.length, options
threads = []
uris.each do |uri|
  threads &lt;&lt; Thread.new do
    begin
      res = open uri
      bar.increment :uri =&gt; uri
    rescue Exception =&gt; e
      bar.increment :uri =&gt; &quot;#{uri} failed&quot;
    end
  end
end
threads.each { |t| t.join }</pre>

<p>The <a href="../../Object.html">Object</a> method progress is also
available:</p>

<pre>progress uris, :width =&gt; 10 do |uri|
  res = open uri
  { :uri =&gt; uri } # Can now use :uri within :format option
end</pre>

    </div>
    

    

    
    

    
    
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
    
        <dt>C</dt>
        <dd>
            <ul>
                
                <li><a href="#method-i-completed-3F">completed?</a></li>
                
            </ul>
        </dd>
    
        <dt>E</dt>
        <dd>
            <ul>
                
                <li><a href="#method-i-erase_line">erase_line</a></li>
                
            </ul>
        </dd>
    
        <dt>F</dt>
        <dd>
            <ul>
                
                <li><a href="#method-i-finished-3F">finished?</a></li>
                
            </ul>
        </dd>
    
        <dt>G</dt>
        <dd>
            <ul>
                
                <li><a href="#method-i-generate_tokens">generate_tokens</a></li>
                
            </ul>
        </dd>
    
        <dt>I</dt>
        <dd>
            <ul>
                
                <li><a href="#method-i-increment">increment</a></li>
                
            </ul>
        </dd>
    
        <dt>N</dt>
        <dd>
            <ul>
                
                <li><a href="#method-c-new">new</a></li>
                
            </ul>
        </dd>
    
        <dt>P</dt>
        <dd>
            <ul>
                
                <li><a href="#method-i-percent_complete">percent_complete</a>,</li>
                
                <li><a href="#method-i-progress_bar">progress_bar</a></li>
                
            </ul>
        </dd>
    
        <dt>S</dt>
        <dd>
            <ul>
                
                <li><a href="#method-i-show">show</a>,</li>
                
                <li><a href="#method-i-steps_remaining">steps_remaining</a></li>
                
            </ul>
        </dd>
    
        <dt>T</dt>
        <dd>
            <ul>
                
                <li><a href="#method-i-time_elapsed">time_elapsed</a>,</li>
                
                <li><a href="#method-i-time_remaining">time_remaining</a></li>
                
            </ul>
        </dd>
    
    </dl>
    

    

    

    

    

    

    
            <div class="sectiontitle">Class Public methods</div>
            
            <div class="method">
                <div class="title" id="method-c-new">
                    
                    <a name="method-c-new"></a><b>new</b>(total, options = {})
                    
                </div>
                
                <div class="description">
                  
<p>Creates a new progress bar.</p>

<h3>Options</h3>

<pre>:title              Title, defaults to &quot;Progress&quot;
:width              Width of :progress_bar
:progress_str       Progress string, defaults to &quot;=&quot;
:incomplete_str     Incomplete bar string, defaults to '.'
:format             Defaults to &quot;:title |:progress_bar| :percent_complete% complete &quot;
:tokens             Additional tokens replaced within the format string
:complete_message   Defaults to &quot;Process complete&quot;</pre>

<h3>Tokens</h3>

<pre>:title 
:percent_complete
:progress_bar
:step
:steps_remaining
:total_steps
:time_elapsed
:time_remaining</pre>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('method-c-new_source')" id="l_method-c-new_source">show</a>
                        
                    </p>
                    <div id="method-c-new_source" class="dyn-source">
                        <pre><span class="ruby-comment"># File lib/commander/user_interaction.rb, line 374</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize</span> <span class="ruby-identifier">total</span>, <span class="ruby-identifier">options</span> = {}
  <span class="ruby-ivar">@total_steps</span>, <span class="ruby-ivar">@step</span>, <span class="ruby-ivar">@start_time</span> = <span class="ruby-identifier">total</span>, <span class="ruby-value">0</span>, <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>
  <span class="ruby-ivar">@title</span> = <span class="ruby-identifier">options</span>.<span class="ruby-identifier">fetch</span> <span class="ruby-value">:title</span>, <span class="ruby-string">'Progress'</span>
  <span class="ruby-ivar">@width</span> = <span class="ruby-identifier">options</span>.<span class="ruby-identifier">fetch</span> <span class="ruby-value">:width</span>, <span class="ruby-value">25</span>
  <span class="ruby-ivar">@progress_str</span> = <span class="ruby-identifier">options</span>.<span class="ruby-identifier">fetch</span> <span class="ruby-value">:progress_str</span>, <span class="ruby-string">'='</span>
  <span class="ruby-ivar">@incomplete_str</span> = <span class="ruby-identifier">options</span>.<span class="ruby-identifier">fetch</span> <span class="ruby-value">:incomplete_str</span>, <span class="ruby-string">'.'</span>
  <span class="ruby-ivar">@complete_message</span> = <span class="ruby-identifier">options</span>.<span class="ruby-identifier">fetch</span> <span class="ruby-value">:complete_message</span>, <span class="ruby-string">'Process complete'</span>
  <span class="ruby-ivar">@format</span> = <span class="ruby-identifier">options</span>.<span class="ruby-identifier">fetch</span> <span class="ruby-value">:format</span>, <span class="ruby-string">':title |:progress_bar| :percent_complete% complete '</span>
  <span class="ruby-ivar">@tokens</span> = <span class="ruby-identifier">options</span>.<span class="ruby-identifier">fetch</span> <span class="ruby-value">:tokens</span>, {}
<span class="ruby-keyword">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="sectiontitle">Instance Public methods</div>
            
            <div class="method">
                <div class="title" id="method-i-completed-3F">
                    
                    <a name="method-i-completed-3F"></a><b>completed?</b>()
                    
                </div>
                
                <div class="description">
                  
<p>Whether or not the operation has completed.</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('method-i-completed-3F_source')" id="l_method-i-completed-3F_source">show</a>
                        
                    </p>
                    <div id="method-i-completed-3F_source" class="dyn-source">
                        <pre><span class="ruby-comment"># File lib/commander/user_interaction.rb, line 465</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">completed?</span>
  <span class="ruby-ivar">@step</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@total_steps</span>
<span class="ruby-keyword">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="method-i-erase_line">
                    
                    <a name="method-i-erase_line"></a><b>erase_line</b>()
                    
                </div>
                
                <div class="description">
                  
<p>Erase previous terminal line.</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('method-i-erase_line_source')" id="l_method-i-erase_line_source">show</a>
                        
                    </p>
                    <div id="method-i-erase_line_source" class="dyn-source">
                        <pre><span class="ruby-comment"># File lib/commander/user_interaction.rb, line 482</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">erase_line</span>
  <span class="ruby-comment"># highline does not expose the output stream</span>
  <span class="ruby-identifier">$terminal</span>.<span class="ruby-identifier">instance_variable_get</span>(<span class="ruby-string">'@output'</span>).<span class="ruby-identifier">print</span> <span class="ruby-string">&quot;\r\e[K&quot;</span>
<span class="ruby-keyword">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="method-i-finished-3F">
                    
                    <a name="method-i-finished-3F"></a><b>finished?</b>()
                    
                </div>
                
                <div class="description">
                  
<p>Whether or not the operation is complete, and we have finished.</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('method-i-finished-3F_source')" id="l_method-i-finished-3F_source">show</a>
                        
                    </p>
                    <div id="method-i-finished-3F_source" class="dyn-source">
                        <pre><span class="ruby-comment"># File lib/commander/user_interaction.rb, line 458</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">finished?</span>
  <span class="ruby-ivar">@step</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@total_steps</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span>
<span class="ruby-keyword">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="method-i-generate_tokens">
                    
                    <a name="method-i-generate_tokens"></a><b>generate_tokens</b>()
                    
                </div>
                
                <div class="description">
                  
<p>Generates tokens for this step.</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('method-i-generate_tokens_source')" id="l_method-i-generate_tokens_source">show</a>
                        
                    </p>
                    <div id="method-i-generate_tokens_source" class="dyn-source">
                        <pre><span class="ruby-comment"># File lib/commander/user_interaction.rb, line 427</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">generate_tokens</span>
  {
    <span class="ruby-value">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@title</span>,
    <span class="ruby-value">:percent_complete</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">percent_complete</span>,
    <span class="ruby-value">:progress_bar</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">progress_bar</span>, 
    <span class="ruby-value">:step</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@step</span>,
    <span class="ruby-value">:steps_remaining</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">steps_remaining</span>,
    <span class="ruby-value">:total_steps</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@total_steps</span>, 
    <span class="ruby-value">:time_elapsed</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;%0.2fs&quot;</span> <span class="ruby-operator">%</span> <span class="ruby-identifier">time_elapsed</span>,
    <span class="ruby-value">:time_remaining</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@step</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span> <span class="ruby-operator">?</span> <span class="ruby-string">&quot;%0.2fs&quot;</span> <span class="ruby-operator">%</span> <span class="ruby-identifier">time_remaining</span> <span class="ruby-operator">:</span> <span class="ruby-string">''</span>,
  }.
  <span class="ruby-identifier">merge!</span> <span class="ruby-ivar">@tokens</span>
<span class="ruby-keyword">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="method-i-increment">
                    
                    <a name="method-i-increment"></a><b>increment</b>(tokens = {})
                    
                </div>
                
                <div class="description">
                  
<p>Increment progress. Optionally pass <em>tokens</em> which can be displayed
in the output format.</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('method-i-increment_source')" id="l_method-i-increment_source">show</a>
                        
                    </p>
                    <div id="method-i-increment_source" class="dyn-source">
                        <pre><span class="ruby-comment"># File lib/commander/user_interaction.rb, line 473</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">increment</span> <span class="ruby-identifier">tokens</span> = {}
  <span class="ruby-ivar">@step</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
  <span class="ruby-ivar">@tokens</span>.<span class="ruby-identifier">merge!</span> <span class="ruby-identifier">tokens</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">tokens</span>.<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">Hash</span>
  <span class="ruby-identifier">show</span>
<span class="ruby-keyword">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="method-i-percent_complete">
                    
                    <a name="method-i-percent_complete"></a><b>percent_complete</b>()
                    
                </div>
                
                <div class="description">
                  
<p>Completion percentage.</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('method-i-percent_complete_source')" id="l_method-i-percent_complete_source">show</a>
                        
                    </p>
                    <div id="method-i-percent_complete_source" class="dyn-source">
                        <pre><span class="ruby-comment"># File lib/commander/user_interaction.rb, line 388</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">percent_complete</span>
  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@total_steps</span>.<span class="ruby-identifier">zero?</span>
    <span class="ruby-value">100</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-ivar">@step</span> * <span class="ruby-value">100</span> <span class="ruby-operator">/</span> <span class="ruby-ivar">@total_steps</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="method-i-progress_bar">
                    
                    <a name="method-i-progress_bar"></a><b>progress_bar</b>()
                    
                </div>
                
                <div class="description">
                  
<p>Formatted progress bar.</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('method-i-progress_bar_source')" id="l_method-i-progress_bar_source">show</a>
                        
                    </p>
                    <div id="method-i-progress_bar_source" class="dyn-source">
                        <pre><span class="ruby-comment"># File lib/commander/user_interaction.rb, line 420</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">progress_bar</span>
  (<span class="ruby-ivar">@progress_str</span> * (<span class="ruby-ivar">@width</span> * <span class="ruby-identifier">percent_complete</span> <span class="ruby-operator">/</span> <span class="ruby-value">100</span>)).<span class="ruby-identifier">ljust</span> <span class="ruby-ivar">@width</span>, <span class="ruby-ivar">@incomplete_str</span>
<span class="ruby-keyword">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="method-i-show">
                    
                    <a name="method-i-show"></a><b>show</b>()
                    
                </div>
                
                <div class="description">
                  
<p>Output the progress bar.</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('method-i-show_source')" id="l_method-i-show_source">show</a>
                        
                    </p>
                    <div id="method-i-show_source" class="dyn-source">
                        <pre><span class="ruby-comment"># File lib/commander/user_interaction.rb, line 444</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">show</span>
  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">finished?</span>
    <span class="ruby-identifier">erase_line</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">completed?</span>
      <span class="ruby-identifier">$terminal</span>.<span class="ruby-identifier">say</span> <span class="ruby-constant">UI</span>.<span class="ruby-identifier">replace_tokens</span>(<span class="ruby-ivar">@complete_message</span>, <span class="ruby-identifier">generate_tokens</span>) <span class="ruby-keyword">if</span> <span class="ruby-ivar">@complete_message</span>.<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">String</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">$terminal</span>.<span class="ruby-identifier">say</span> <span class="ruby-constant">UI</span>.<span class="ruby-identifier">replace_tokens</span>(<span class="ruby-ivar">@format</span>, <span class="ruby-identifier">generate_tokens</span>) <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">' '</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="method-i-steps_remaining">
                    
                    <a name="method-i-steps_remaining"></a><b>steps_remaining</b>()
                    
                </div>
                
                <div class="description">
                  
<p>Number of steps left.</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('method-i-steps_remaining_source')" id="l_method-i-steps_remaining_source">show</a>
                        
                    </p>
                    <div id="method-i-steps_remaining_source" class="dyn-source">
                        <pre><span class="ruby-comment"># File lib/commander/user_interaction.rb, line 413</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">steps_remaining</span>
  <span class="ruby-ivar">@total_steps</span> <span class="ruby-operator">-</span> <span class="ruby-ivar">@step</span>
<span class="ruby-keyword">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="method-i-time_elapsed">
                    
                    <a name="method-i-time_elapsed"></a><b>time_elapsed</b>()
                    
                </div>
                
                <div class="description">
                  
<p>Time that has elapsed since the operation started.</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('method-i-time_elapsed_source')" id="l_method-i-time_elapsed_source">show</a>
                        
                    </p>
                    <div id="method-i-time_elapsed_source" class="dyn-source">
                        <pre><span class="ruby-comment"># File lib/commander/user_interaction.rb, line 399</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">time_elapsed</span>
  <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span> <span class="ruby-operator">-</span> <span class="ruby-ivar">@start_time</span>
<span class="ruby-keyword">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="method-i-time_remaining">
                    
                    <a name="method-i-time_remaining"></a><b>time_remaining</b>()
                    
                </div>
                
                <div class="description">
                  
<p>Estimated time remaining.</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('method-i-time_remaining_source')" id="l_method-i-time_remaining_source">show</a>
                        
                    </p>
                    <div id="method-i-time_remaining_source" class="dyn-source">
                        <pre><span class="ruby-comment"># File lib/commander/user_interaction.rb, line 406</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">time_remaining</span>
  (<span class="ruby-identifier">time_elapsed</span> <span class="ruby-operator">/</span> <span class="ruby-ivar">@step</span>) * <span class="ruby-identifier">steps_remaining</span>
<span class="ruby-keyword">end</span></pre>
                    </div>
                </div>
                
            </div>
            
</div>
    </div>
  </body>
</html>    