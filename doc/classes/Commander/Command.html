<?xml version="1.0" encoding="%charset%"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
    <title>Commander::Command</title>
    <meta http-equiv="Content-Type" content="text/html; charset=%charset%" />
    <link rel="stylesheet" href="../../css/main.css" type="text/css" media="screen" />
    <script src="../../js/main.js" type="text/javascript" charset="utf-8"></script>
</head>

<body>     
    <table width="100%" border='0' cellpadding='0' cellspacing='0' class='banner'>
        <tr>
            <td class="file-title"><span class="file-title-prefix">Class</span><br />Commander::Command</td>
            <td align="right">
                <table cellspacing="0" cellpadding="2">
                    <tr valign="top">
                        <td>In:</td>
                        <td>
                            
                            <a href="../../files/lib/commander/command_rb.html">lib/commander/command.rb</a>
                            
                        </td>
                    </tr>
                    
                    <tr>
                        <td>Parent:</td>
                        <td>
                            
                            <a href="../Object.html">Object</a>
                            
                        </td>
                    </tr>
                    
                </table>
            </td>
        </tr>
    </table>
    <div id="bodyContent">
        <div id="content">
    

    

    
    

    
    
    <div class="sectiontitle">Methods</div>
    <ul>
        
        <li><a href="#M000014">call</a></li>
        
        <li><a href="#M000007">example</a></li>
        
        <li><a href="#M000006">new</a></li>
        
        <li><a href="#M000008">option</a></li>
        
        <li><a href="#M000016">option_proc</a></li>
        
        <li><a href="#M000013">parse_options_and_call_procs</a></li>
        
        <li><a href="#M000015">proxy_option_struct</a></li>
        
        <li><a href="#M000012">run</a></li>
        
        <li><a href="#M000011">when_called</a></li>
        
    </ul>
    

    

    

    
    <div class="sectiontitle">Classes and Modules</div>
    <ul>
        
        <li><span class="type">CLASS</span> <a href="Command/Options.html">Commander::Command::Options</a></li>
        
    </ul>
    

    

    
    <div class="sectiontitle">Attributes</div>
    <table border='0' cellpadding='5'>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [RW]
            </td>
            <td class='attr-name'>name</td>
            <td class='attr-desc'></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [RW]
            </td>
            <td class='attr-name'>examples</td>
            <td class='attr-desc'></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [RW]
            </td>
            <td class='attr-name'>syntax</td>
            <td class='attr-desc'></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [RW]
            </td>
            <td class='attr-name'>description</td>
            <td class='attr-desc'></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [RW]
            </td>
            <td class='attr-name'>summary</td>
            <td class='attr-desc'></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [RW]
            </td>
            <td class='attr-name'>proxy_options</td>
            <td class='attr-desc'></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [RW]
            </td>
            <td class='attr-name'>options</td>
            <td class='attr-desc'></td>
        </tr>
        
    </table>
    

    
            <div class="sectiontitle">Class Public methods</div>
            
            <div class="method">
                <div class="title">
                    
                    <a name="M000006"></a><b>new</b>(name)
                    
                </div>
                
                <div class="description">
                    <p>
Initialize new command with specified <tt>name</tt>.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000006_source')" id="l_M000006_source">show</a>
                        
                        | <a href="http://github.com/visionmedia/commander/blob/726381f74bb3e6448a739cbac02c198471f8d15b/lib/commander/command.rb#L40" target="_blank" class="github_url">on GitHub</a>
                        
                    </p>
                    <div id="M000006_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/commander/command.rb, line 40</span>
40:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span> <span class="ruby-identifier">name</span>
41:       <span class="ruby-ivar">@name</span>, <span class="ruby-ivar">@examples</span>, <span class="ruby-ivar">@when_called</span> = <span class="ruby-identifier">name</span>.<span class="ruby-identifier">to_s</span>, [], []
42:       <span class="ruby-ivar">@options</span>, <span class="ruby-ivar">@proxy_options</span> = [], []
43:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="sectiontitle">Instance Public methods</div>
            
            <div class="method">
                <div class="title">
                    
                    <a name="M000014"></a><b>call</b>(args = [])
                    
                </div>
                
                <div class="description">
                    <p>
Call the commands <a href="Command.html#M000011">when_called</a> block with
<tt>args</tt>.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000014_source')" id="l_M000014_source">show</a>
                        
                        | <a href="http://github.com/visionmedia/commander/blob/726381f74bb3e6448a739cbac02c198471f8d15b/lib/commander/command.rb#L172" target="_blank" class="github_url">on GitHub</a>
                        
                    </p>
                    <div id="M000014_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/commander/command.rb, line 172</span>
172:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">call</span> <span class="ruby-identifier">args</span> = []
173:       <span class="ruby-identifier">object</span> = <span class="ruby-ivar">@when_called</span>.<span class="ruby-identifier">shift</span>
174:       <span class="ruby-identifier">meth</span> = <span class="ruby-ivar">@when_called</span>.<span class="ruby-identifier">shift</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">:call</span>
175:       <span class="ruby-identifier">options</span> = <span class="ruby-identifier">proxy_option_struct</span>
176:       <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">object</span>
177:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Proc</span>  ; <span class="ruby-identifier">object</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">args</span>, <span class="ruby-identifier">options</span>)
178:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Class</span> ; <span class="ruby-identifier">meth</span> <span class="ruby-operator">!=</span> <span class="ruby-identifier">:call</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">object</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">meth</span>, <span class="ruby-identifier">args</span>, <span class="ruby-identifier">options</span>) <span class="ruby-operator">:</span> <span class="ruby-identifier">object</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">args</span>, <span class="ruby-identifier">options</span>)
179:       <span class="ruby-keyword kw">else</span>         <span class="ruby-identifier">object</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">meth</span>, <span class="ruby-identifier">args</span>, <span class="ruby-identifier">options</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">object</span>
180:       <span class="ruby-keyword kw">end</span> 
181:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title">
                    
                    <a name="M000007"></a><b>example</b>(description, command)
                    
                </div>
                
                <div class="description">
                    <p>
Add a usage example for this command.
</p>
<p>
Usage examples are later displayed in help documentation created by the
help formatters.
</p>
<h3>Examples:</h3>
<pre>
  command :something do |c|
    c.example &quot;Should do something&quot;, &quot;my_command something&quot;
  end
</pre>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000007_source')" id="l_M000007_source">show</a>
                        
                        | <a href="http://github.com/visionmedia/commander/blob/726381f74bb3e6448a739cbac02c198471f8d15b/lib/commander/command.rb#L58" target="_blank" class="github_url">on GitHub</a>
                        
                    </p>
                    <div id="M000007_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/commander/command.rb, line 58</span>
58:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">example</span> <span class="ruby-identifier">description</span>, <span class="ruby-identifier">command</span> 
59:       <span class="ruby-ivar">@examples</span> <span class="ruby-operator">&lt;&lt;</span> [<span class="ruby-identifier">description</span>, <span class="ruby-identifier">command</span>]
60:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title">
                    
                    <a name="M000008"></a><b>option</b>(*args, &amp;block)
                    
                </div>
                
                <div class="description">
                    <p>
Add an option.
</p>
<p>
<a href="Command/Options.html">Options</a> are parsed via OptionParser so
view it for additional usage documentation. A block may optionally be
passed to handle the option, otherwise the <em>options</em> struct seen
below contains the results of this option. This handles common formats such
as:
</p>
<pre>
  -h, --help          options.help           # =&gt; bool
  --[no-]feature      options.feature        # =&gt; bool
  --large-switch      options.large_switch   # =&gt; bool
  --file FILE         options.file           # =&gt; file passed
  --list WORDS        options.list           # =&gt; array
  --date [DATE]       options.date           # =&gt; date or nil when optional argument not set
</pre>
<h3>Examples:</h3>
<pre>
  command :something do |c|
    c.option '--recursive', 'Do something recursively'
    c.option '--file FILE', 'Specify a file'
    c.option('--info', 'Display info') { puts &quot;handle with block&quot; }
    c.option '--[no-]feature', 'With or without feature'
    c.option '--list FILES', Array, 'List the files specified'

    c.when_called do |args, options|
      do_something_recursively if options.recursive
      do_something_with_file options.file if options.file
    end
  end
</pre>
<h3>Help Formatters:</h3>
<p>
This method also parses the arguments passed in order to determine which
were switches, and which were descriptions for the option which can later
be used within help formatters using option[:switches] and
option[:description].
</p>
<h3>Input Parsing:</h3>
<p>
Since <a href="../Commander.html">Commander</a> utilizes OptionParser you
can pre-parse and evaluate option arguments. Simply require
&#8216;optparse/time&#8217;, or &#8216;optparse/date&#8217;, as these
objects must respond to parse.
</p>
<pre>
  c.option '--time TIME', Time
  c.option '--date [DATE]', Date
</pre>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000008_source')" id="l_M000008_source">show</a>
                        
                        | <a href="http://github.com/visionmedia/commander/blob/726381f74bb3e6448a739cbac02c198471f8d15b/lib/commander/command.rb#L109" target="_blank" class="github_url">on GitHub</a>
                        
                    </p>
                    <div id="M000008_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/commander/command.rb, line 109</span>
109:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">option</span> <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>
110:       <span class="ruby-identifier">switches</span>, <span class="ruby-identifier">description</span> = <span class="ruby-constant">Runner</span>.<span class="ruby-identifier">seperate_switches_from_description</span> <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>
111:       <span class="ruby-identifier">proc</span> = <span class="ruby-identifier">block</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">option_proc</span>(<span class="ruby-identifier">switches</span>)
112:       <span class="ruby-ivar">@options</span> <span class="ruby-operator">&lt;&lt;</span> {
113:         <span class="ruby-identifier">:args</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">args</span>,
114:         <span class="ruby-identifier">:proc</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">proc</span>,
115:         <span class="ruby-identifier">:switches</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">switches</span>,
116:         <span class="ruby-identifier">:description</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">description</span>,
117:       }
118:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title">
                    
                    <a name="M000016"></a><b>option_proc</b>(switches)
                    
                </div>
                
                <div class="description">
                    <p>
Option proxy proc used when a block is not explicitly passed via the <a
href="Command.html#M000008">option</a> method. This allows commander to
auto-populate and work with option values.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000016_source')" id="l_M000016_source">show</a>
                        
                        | <a href="http://github.com/visionmedia/commander/blob/726381f74bb3e6448a739cbac02c198471f8d15b/lib/commander/command.rb#L199" target="_blank" class="github_url">on GitHub</a>
                        
                    </p>
                    <div id="M000016_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/commander/command.rb, line 199</span>
199:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">option_proc</span> <span class="ruby-identifier">switches</span>
200:       <span class="ruby-identifier">lambda</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">value</span><span class="ruby-operator">|</span> <span class="ruby-identifier">proxy_options</span> <span class="ruby-operator">&lt;&lt;</span> [<span class="ruby-constant">Runner</span>.<span class="ruby-identifier">switch_to_sym</span>(<span class="ruby-identifier">switches</span>.<span class="ruby-identifier">last</span>), <span class="ruby-identifier">value</span>] } 
201:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title">
                    
                    <a name="M000013"></a><b>parse_options_and_call_procs</b>(*args)
                    
                </div>
                
                <div class="description">
                    <p>
Parses options and calls associated procs, returning the arguments
remaining.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000013_source')" id="l_M000013_source">show</a>
                        
                        | <a href="http://github.com/visionmedia/commander/blob/726381f74bb3e6448a739cbac02c198471f8d15b/lib/commander/command.rb#L161" target="_blank" class="github_url">on GitHub</a>
                        
                    </p>
                    <div id="M000013_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/commander/command.rb, line 161</span>
161:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">parse_options_and_call_procs</span> <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>
162:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">args</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">empty?</span>
163:       <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">inject</span> <span class="ruby-constant">OptionParser</span>.<span class="ruby-identifier">new</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">opts</span>, <span class="ruby-identifier">option</span><span class="ruby-operator">|</span> 
164:         <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">on</span> <span class="ruby-operator">*</span><span class="ruby-identifier">option</span>[<span class="ruby-identifier">:args</span>], <span class="ruby-operator">&amp;</span><span class="ruby-identifier">option</span>[<span class="ruby-identifier">:proc</span>]
165:         <span class="ruby-identifier">opts</span>
166:       <span class="ruby-keyword kw">end</span>.<span class="ruby-identifier">parse!</span> <span class="ruby-identifier">args</span>
167:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title">
                    
                    <a name="M000015"></a><b>proxy_option_struct</b>()
                    
                </div>
                
                <div class="description">
                    <p>
Creates an <a href="Command/Options.html">Options</a> instance populated
with the option values collected by the <a
href="Command.html#M000016">option_proc</a>.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000015_source')" id="l_M000015_source">show</a>
                        
                        | <a href="http://github.com/visionmedia/commander/blob/726381f74bb3e6448a739cbac02c198471f8d15b/lib/commander/command.rb#L187" target="_blank" class="github_url">on GitHub</a>
                        
                    </p>
                    <div id="M000015_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/commander/command.rb, line 187</span>
187:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">proxy_option_struct</span>
188:       <span class="ruby-identifier">proxy_options</span>.<span class="ruby-identifier">inject</span> <span class="ruby-constant">Options</span>.<span class="ruby-identifier">new</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">options</span>, (<span class="ruby-identifier">option</span>, <span class="ruby-identifier">value</span>)<span class="ruby-operator">|</span>
189:         <span class="ruby-identifier">options</span>.<span class="ruby-identifier">__send__</span> <span class="ruby-identifier">:&quot;#{option}=&quot;</span>, <span class="ruby-identifier">value</span>
190:         <span class="ruby-identifier">options</span>
191:       <span class="ruby-keyword kw">end</span>
192:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title">
                    
                    <a name="M000012"></a><b>run</b>(*args)
                    
                </div>
                
                <div class="description">
                    <p>
Run the command with <em>args</em>.
</p>
<ul>
<li>parses options, call option blocks

</li>
<li>invokes <a href="Command.html#M000011">when_called</a> proc

</li>
</ul>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000012_source')" id="l_M000012_source">show</a>
                        
                        | <a href="http://github.com/visionmedia/commander/blob/726381f74bb3e6448a739cbac02c198471f8d15b/lib/commander/command.rb#L153" target="_blank" class="github_url">on GitHub</a>
                        
                    </p>
                    <div id="M000012_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/commander/command.rb, line 153</span>
153:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">run</span> <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>
154:       <span class="ruby-identifier">call</span> <span class="ruby-identifier">parse_options_and_call_procs</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
155:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title">
                    
                    <a name="M000011"></a><b>when_called</b>(*args, &amp;block)
                    
                </div>
                
                <div class="description">
                    <p>
Handle execution of command. The handler may be a class, object, or block
(see examples below).
</p>
<h3>Examples:</h3>
<pre>
  # Simple block handling
  c.when_called do |args, options|
     # do something
  end

  # Create inst of Something and pass args / options
  c.when_called MyLib::Command::Something

  # Create inst of Something and use arbitrary method
   c.when_called MyLib::Command::Something, :some_method

  # Pass an object to handle callback (requires method symbol)
  c.when_called SomeObject, :some_method
</pre>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000011_source')" id="l_M000011_source">show</a>
                        
                        | <a href="http://github.com/visionmedia/commander/blob/726381f74bb3e6448a739cbac02c198471f8d15b/lib/commander/command.rb#L141" target="_blank" class="github_url">on GitHub</a>
                        
                    </p>
                    <div id="M000011_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/commander/command.rb, line 141</span>
141:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">when_called</span> <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>
142:       <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-value str">'must pass an object, class, or block.'</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-keyword kw">and</span> <span class="ruby-operator">!</span><span class="ruby-identifier">block</span>
143:       <span class="ruby-ivar">@when_called</span> = <span class="ruby-identifier">block</span> <span class="ruby-value">? </span>[<span class="ruby-identifier">block</span>] <span class="ruby-operator">:</span> <span class="ruby-identifier">args</span>
144:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
</div>
    </div>
  </body>
</html>    